name: Ø±Ù…Ø¶Ø§Ù† 2026

on:
  schedule:
    - cron: '0 2 * * *'
  workflow_dispatch:
    inputs:
      url:
        description: 'URL to extract from'
        required: false
        default: 'https://laroza.bond/category.php?cat=ramadan-2026'

jobs:
  extract:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v3
      
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        
    - name: Install dependencies
      run: |
        npm install node-html-parser node-fetch@2
        
    - name: Create package.json
      run: |
        echo '{
          "name": "ramadan-2026",
          "version": "1.0.0",
          "description": "Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆÙ†Ø´Ø± Ø­Ù„Ù‚Ø§Øª Ø±Ù…Ø¶Ø§Ù† 2026",
          "main": "extract-episodes.js",
          "scripts": {
            "start": "node extract-episodes.js",
            "extract": "node extract-episodes.js"
          },
          "dependencies": {
            "node-html-parser": "^6.1.5",
            "node-fetch": "^2.6.7"
          }
        }' > package.json
        
    - name: Run extractor
      run: npm run extract ${{ github.event.inputs.url }}
      continue-on-error: true
      
    - name: Commit and push changes
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add Ramadan/ extracted_history.json || echo "No files to add"
        git commit -m "ðŸ“¦ ØªØ­Ø¯ÙŠØ«: Ø­Ù„Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø© $(date '+%Y-%m-%d %H:%M')" || echo "No changes to commit"
        git push || echo "Push failed"
